{"ast":null,"code":"var _jsxFileName = \"/home/steve/amala/client/src/auth/RequireAuth.js\",\n  _s = $RefreshSig$();\nimport { Navigate, useLocation } from \"react-router-dom\";\nimport { useAuth } from \"./AuthContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function RequireAuth({\n  children\n}) {\n  _s();\n  const {\n    user,\n    profile,\n    loading\n  } = useAuth();\n  const location = useLocation();\n\n  // 1. Wait for AuthContext to finish\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: 50,\n        textAlign: 'center'\n      },\n      children: \"Loading application...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 10,\n      columnNumber: 12\n    }, this);\n  }\n\n  // 2. If no user, go to Login\n  if (!user) {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\",\n      state: {\n        from: location\n      },\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 15,\n      columnNumber: 12\n    }, this);\n  }\n\n  // 3. ✅ CRITICAL FIX: If User exists but Profile is missing, STOP HERE.\n  // This prevents the \"White Screen\" crash in Navbar/Sidebar.\n  if (!profile) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: 40,\n        textAlign: \"center\",\n        color: \"#d00\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"\\u26A0\\uFE0F Profile Error\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 23,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"User is logged in, but we could not load your profile data.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 24,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Debug Info:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 25,\n          columnNumber: 12\n        }, this), \" User ID: \", user.id]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 25,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Possible causes: Internet issues, RLS Policies, or Database connection.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 26,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => window.location.reload(),\n        style: {\n          padding: \"10px 20px\",\n          cursor: \"pointer\",\n          marginTop: 20\n        },\n        children: \"Retry Connection\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 27,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 22,\n      columnNumber: 7\n    }, this);\n  }\n\n  // 4. Safe to render Dashboard\n  return children;\n}\n_s(RequireAuth, \"lSDzcenYjlEitYiT//XxrUxtOEU=\", false, function () {\n  return [useAuth, useLocation];\n});\n_c = RequireAuth;\nvar _c;\n$RefreshReg$(_c, \"RequireAuth\");","map":{"version":3,"names":["Navigate","useLocation","useAuth","jsxDEV","_jsxDEV","RequireAuth","children","_s","user","profile","loading","location","style","padding","textAlign","fileName","_jsxFileName","lineNumber","columnNumber","to","state","from","replace","color","id","onClick","window","reload","cursor","marginTop","_c","$RefreshReg$"],"sources":["/home/steve/amala/client/src/auth/RequireAuth.js"],"sourcesContent":["import { Navigate, useLocation } from \"react-router-dom\";\nimport { useAuth } from \"./AuthContext\";\n\nexport default function RequireAuth({ children }) {\n  const { user, profile, loading } = useAuth();\n  const location = useLocation();\n\n  // 1. Wait for AuthContext to finish\n  if (loading) {\n    return <div style={{ padding: 50, textAlign: 'center' }}>Loading application...</div>;\n  }\n\n  // 2. If no user, go to Login\n  if (!user) {\n    return <Navigate to=\"/login\" state={{ from: location }} replace />;\n  }\n\n  // 3. ✅ CRITICAL FIX: If User exists but Profile is missing, STOP HERE.\n  // This prevents the \"White Screen\" crash in Navbar/Sidebar.\n  if (!profile) {\n    return (\n      <div style={{ padding: 40, textAlign: \"center\", color: \"#d00\" }}>\n        <h2>⚠️ Profile Error</h2>\n        <p>User is logged in, but we could not load your profile data.</p>\n        <p><strong>Debug Info:</strong> User ID: {user.id}</p>\n        <p>Possible causes: Internet issues, RLS Policies, or Database connection.</p>\n        <button \n          onClick={() => window.location.reload()}\n          style={{ padding: \"10px 20px\", cursor: \"pointer\", marginTop: 20 }}\n        >\n          Retry Connection\n        </button>\n      </div>\n    );\n  }\n\n  // 4. Safe to render Dashboard\n  return children;\n}"],"mappings":";;AAAA,SAASA,QAAQ,EAAEC,WAAW,QAAQ,kBAAkB;AACxD,SAASC,OAAO,QAAQ,eAAe;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAExC,eAAe,SAASC,WAAWA,CAAC;EAAEC;AAAS,CAAC,EAAE;EAAAC,EAAA;EAChD,MAAM;IAAEC,IAAI;IAAEC,OAAO;IAAEC;EAAQ,CAAC,GAAGR,OAAO,CAAC,CAAC;EAC5C,MAAMS,QAAQ,GAAGV,WAAW,CAAC,CAAC;;EAE9B;EACA,IAAIS,OAAO,EAAE;IACX,oBAAON,OAAA;MAAKQ,KAAK,EAAE;QAAEC,OAAO,EAAE,EAAE;QAAEC,SAAS,EAAE;MAAS,CAAE;MAAAR,QAAA,EAAC;IAAsB;MAAAS,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC;EACvF;;EAEA;EACA,IAAI,CAACV,IAAI,EAAE;IACT,oBAAOJ,OAAA,CAACJ,QAAQ;MAACmB,EAAE,EAAC,QAAQ;MAACC,KAAK,EAAE;QAAEC,IAAI,EAAEV;MAAS,CAAE;MAACW,OAAO;IAAA;MAAAP,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EACpE;;EAEA;EACA;EACA,IAAI,CAACT,OAAO,EAAE;IACZ,oBACEL,OAAA;MAAKQ,KAAK,EAAE;QAAEC,OAAO,EAAE,EAAE;QAAEC,SAAS,EAAE,QAAQ;QAAES,KAAK,EAAE;MAAO,CAAE;MAAAjB,QAAA,gBAC9DF,OAAA;QAAAE,QAAA,EAAI;MAAgB;QAAAS,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACzBd,OAAA;QAAAE,QAAA,EAAG;MAA2D;QAAAS,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,eAClEd,OAAA;QAAAE,QAAA,gBAAGF,OAAA;UAAAE,QAAA,EAAQ;QAAW;UAAAS,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,cAAU,EAACV,IAAI,CAACgB,EAAE;MAAA;QAAAT,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACtDd,OAAA;QAAAE,QAAA,EAAG;MAAuE;QAAAS,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,eAC9Ed,OAAA;QACEqB,OAAO,EAAEA,CAAA,KAAMC,MAAM,CAACf,QAAQ,CAACgB,MAAM,CAAC,CAAE;QACxCf,KAAK,EAAE;UAAEC,OAAO,EAAE,WAAW;UAAEe,MAAM,EAAE,SAAS;UAAEC,SAAS,EAAE;QAAG,CAAE;QAAAvB,QAAA,EACnE;MAED;QAAAS,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CAAC;EAEV;;EAEA;EACA,OAAOZ,QAAQ;AACjB;AAACC,EAAA,CAnCuBF,WAAW;EAAA,QACEH,OAAO,EACzBD,WAAW;AAAA;AAAA6B,EAAA,GAFNzB,WAAW;AAAA,IAAAyB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}