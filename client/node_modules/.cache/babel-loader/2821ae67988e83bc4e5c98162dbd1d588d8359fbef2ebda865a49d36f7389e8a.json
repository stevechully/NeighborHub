{"ast":null,"code":"import{Navigate,useLocation}from\"react-router-dom\";import{useAuth}from\"./AuthContext\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function RequireAuth(_ref){let{children}=_ref;const{user,profile,loading}=useAuth();const location=useLocation();// 1. Still checking session? Show loader.\nif(loading){return/*#__PURE__*/_jsx(\"div\",{style:{padding:50,textAlign:'center'},children:\"Loading application...\"});}// 2. No User? Go to login.\nif(!user){return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",state:{from:location},replace:true});}// 3. User exists, but Profile failed to load? \n// This prevents the \"White Screen\" crash where code tries to access profile.roles\nif(!profile){return/*#__PURE__*/_jsxs(\"div\",{style:{padding:50,textAlign:\"center\"},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Profile Error\"}),/*#__PURE__*/_jsx(\"p\",{children:\"We could not load your profile data. Please contact support.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.location.reload(),children:\"Retry\"})]});}// 4. All good? Render the page.\nreturn children;}","map":{"version":3,"names":["Navigate","useLocation","useAuth","jsx","_jsx","jsxs","_jsxs","RequireAuth","_ref","children","user","profile","loading","location","style","padding","textAlign","to","state","from","replace","onClick","window","reload"],"sources":["/home/steve/amala/client/src/auth/RequireAuth.js"],"sourcesContent":["import { Navigate, useLocation } from \"react-router-dom\";\nimport { useAuth } from \"./AuthContext\";\n\nexport default function RequireAuth({ children }) {\n  const { user, profile, loading } = useAuth();\n  const location = useLocation();\n\n  // 1. Still checking session? Show loader.\n  if (loading) {\n    return <div style={{ padding: 50, textAlign: 'center' }}>Loading application...</div>;\n  }\n\n  // 2. No User? Go to login.\n  if (!user) {\n    return <Navigate to=\"/login\" state={{ from: location }} replace />;\n  }\n\n  // 3. User exists, but Profile failed to load? \n  // This prevents the \"White Screen\" crash where code tries to access profile.roles\n  if (!profile) {\n    return (\n      <div style={{ padding: 50, textAlign: \"center\" }}>\n        <h3>Profile Error</h3>\n        <p>We could not load your profile data. Please contact support.</p>\n        <button onClick={() => window.location.reload()}>Retry</button>\n      </div>\n    );\n  }\n\n  // 4. All good? Render the page.\n  return children;\n}"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,WAAW,KAAQ,kBAAkB,CACxD,OAASC,OAAO,KAAQ,eAAe,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAExC,cAAe,SAAS,CAAAC,WAAWA,CAAAC,IAAA,CAAe,IAAd,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAC9C,KAAM,CAAEE,IAAI,CAAEC,OAAO,CAAEC,OAAQ,CAAC,CAAGV,OAAO,CAAC,CAAC,CAC5C,KAAM,CAAAW,QAAQ,CAAGZ,WAAW,CAAC,CAAC,CAE9B;AACA,GAAIW,OAAO,CAAE,CACX,mBAAOR,IAAA,QAAKU,KAAK,CAAE,CAAEC,OAAO,CAAE,EAAE,CAAEC,SAAS,CAAE,QAAS,CAAE,CAAAP,QAAA,CAAC,wBAAsB,CAAK,CAAC,CACvF,CAEA;AACA,GAAI,CAACC,IAAI,CAAE,CACT,mBAAON,IAAA,CAACJ,QAAQ,EAACiB,EAAE,CAAC,QAAQ,CAACC,KAAK,CAAE,CAAEC,IAAI,CAAEN,QAAS,CAAE,CAACO,OAAO,MAAE,CAAC,CACpE,CAEA;AACA;AACA,GAAI,CAACT,OAAO,CAAE,CACZ,mBACEL,KAAA,QAAKQ,KAAK,CAAE,CAAEC,OAAO,CAAE,EAAE,CAAEC,SAAS,CAAE,QAAS,CAAE,CAAAP,QAAA,eAC/CL,IAAA,OAAAK,QAAA,CAAI,eAAa,CAAI,CAAC,cACtBL,IAAA,MAAAK,QAAA,CAAG,8DAA4D,CAAG,CAAC,cACnEL,IAAA,WAAQiB,OAAO,CAAEA,CAAA,GAAMC,MAAM,CAACT,QAAQ,CAACU,MAAM,CAAC,CAAE,CAAAd,QAAA,CAAC,OAAK,CAAQ,CAAC,EAC5D,CAAC,CAEV,CAEA;AACA,MAAO,CAAAA,QAAQ,CACjB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}