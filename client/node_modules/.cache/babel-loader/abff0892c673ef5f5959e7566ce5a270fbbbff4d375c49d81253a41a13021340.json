{"ast":null,"code":"import{useEffect}from\"react\";import{supabase}from\"../lib/supabase\";// âœ… make sure this path is correct\nexport default function useParcelNotifications(userId,onNewParcel){useEffect(()=>{if(!userId)return;console.log(\"ðŸ“¡ Parcel realtime listener started for:\",userId);const channel=supabase.channel(\"parcel-notifications\").on(\"postgres_changes\",{event:\"INSERT\",schema:\"public\",table:\"parcels\",filter:\"resident_id=eq.\".concat(userId)},payload=>{console.log(\"ðŸ“¦ New parcel received realtime:\",payload.new);if(onNewParcel)onNewParcel(payload.new);}).subscribe(status=>{console.log(\"ðŸ“¡ Parcel channel status:\",status);});return()=>{supabase.removeChannel(channel);};},[userId,onNewParcel]);}","map":{"version":3,"names":["useEffect","supabase","useParcelNotifications","userId","onNewParcel","console","log","channel","on","event","schema","table","filter","concat","payload","new","subscribe","status","removeChannel"],"sources":["/home/steve/amala/client/src/hooks/useParcelNotifications.js"],"sourcesContent":["import { useEffect } from \"react\";\nimport { supabase } from \"../lib/supabase\"; // âœ… make sure this path is correct\n\nexport default function useParcelNotifications(userId, onNewParcel) {\n  useEffect(() => {\n    if (!userId) return;\n\n    console.log(\"ðŸ“¡ Parcel realtime listener started for:\", userId);\n\n    const channel = supabase\n      .channel(\"parcel-notifications\")\n      .on(\n        \"postgres_changes\",\n        {\n          event: \"INSERT\",\n          schema: \"public\",\n          table: \"parcels\",\n          filter: `resident_id=eq.${userId}`,\n        },\n        (payload) => {\n          console.log(\"ðŸ“¦ New parcel received realtime:\", payload.new);\n          if (onNewParcel) onNewParcel(payload.new);\n        }\n      )\n      .subscribe((status) => {\n        console.log(\"ðŸ“¡ Parcel channel status:\", status);\n      });\n\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, [userId, onNewParcel]);\n}\n"],"mappings":"AAAA,OAASA,SAAS,KAAQ,OAAO,CACjC,OAASC,QAAQ,KAAQ,iBAAiB,CAAE;AAE5C,cAAe,SAAS,CAAAC,sBAAsBA,CAACC,MAAM,CAAEC,WAAW,CAAE,CAClEJ,SAAS,CAAC,IAAM,CACd,GAAI,CAACG,MAAM,CAAE,OAEbE,OAAO,CAACC,GAAG,CAAC,0CAA0C,CAAEH,MAAM,CAAC,CAE/D,KAAM,CAAAI,OAAO,CAAGN,QAAQ,CACrBM,OAAO,CAAC,sBAAsB,CAAC,CAC/BC,EAAE,CACD,kBAAkB,CAClB,CACEC,KAAK,CAAE,QAAQ,CACfC,MAAM,CAAE,QAAQ,CAChBC,KAAK,CAAE,SAAS,CAChBC,MAAM,mBAAAC,MAAA,CAAoBV,MAAM,CAClC,CAAC,CACAW,OAAO,EAAK,CACXT,OAAO,CAACC,GAAG,CAAC,kCAAkC,CAAEQ,OAAO,CAACC,GAAG,CAAC,CAC5D,GAAIX,WAAW,CAAEA,WAAW,CAACU,OAAO,CAACC,GAAG,CAAC,CAC3C,CACF,CAAC,CACAC,SAAS,CAAEC,MAAM,EAAK,CACrBZ,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAEW,MAAM,CAAC,CAClD,CAAC,CAAC,CAEJ,MAAO,IAAM,CACXhB,QAAQ,CAACiB,aAAa,CAACX,OAAO,CAAC,CACjC,CAAC,CACH,CAAC,CAAE,CAACJ,MAAM,CAAEC,WAAW,CAAC,CAAC,CAC3B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}