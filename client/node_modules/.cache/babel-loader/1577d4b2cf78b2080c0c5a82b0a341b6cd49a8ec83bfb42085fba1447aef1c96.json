{"ast":null,"code":"import { apiFetch } from \"./client\";\n\n/**\n * GET worker bookings (Standard)\n * - Resident/Worker: uses default RLS endpoint\n * - Admin: uses admin endpoint to bypass RLS\n */\nexport function fetchWorkerBookings(filters = {}, isAdmin = false) {\n  const cleanFilters = {};\n  if (filters.status) {\n    cleanFilters.status = filters.status;\n  }\n  const params = new URLSearchParams(cleanFilters).toString();\n  const baseUrl = isAdmin ? \"/api/worker-services/admin/all\" : \"/api/worker-services\";\n  return apiFetch(`${baseUrl}${params ? `?${params}` : \"\"}`);\n}\n\n/**\n * ✅ NEW: GET /api/worker-services/my-bookings\n * Resident-specific fetch that includes merged payment/refund data\n */\nexport function fetchMyWorkerBookings() {\n  return apiFetch(\"/api/worker-services/my-bookings\");\n}\n\n/**\n * POST /api/worker-services\n * Resident creates booking\n */\nexport function createWorkerBooking(payload) {\n  return apiFetch(\"/api/worker-services\", {\n    method: \"POST\",\n    body: JSON.stringify(payload)\n  });\n}\n\n/**\n * PATCH /api/worker-services/:id/assign\n * Admin assigns worker\n */\nexport function assignWorkerToBooking(id, worker_id) {\n  return apiFetch(`/api/worker-services/${id}/assign`, {\n    method: \"PATCH\",\n    body: JSON.stringify({\n      worker_id\n    })\n  });\n}\n\n/**\n * PATCH /api/worker-services/:id/status\n * Worker updates booking status\n */\nexport function updateWorkerBookingStatus(id, status) {\n  return apiFetch(`/api/worker-services/${id}/status`, {\n    method: \"PATCH\",\n    body: JSON.stringify({\n      status\n    })\n  });\n}\n\n/**\n * POST /api/worker-services/:id/pay\n * Resident pays for a completed service\n */\nexport function payForWorkerService(id, payload) {\n  return apiFetch(`/api/worker-services/${id}/pay`, {\n    method: \"POST\",\n    body: JSON.stringify(payload)\n  });\n}\n\n/**\n * ✅ NEW: POST /api/refunds/worker/request\n * Resident requests a refund for a worker service payment\n */\nexport function requestWorkerRefund(paymentId, reason = \"Service not needed\") {\n  return apiFetch(\"/api/refunds/worker/request\", {\n    method: \"POST\",\n    body: JSON.stringify({\n      payment_id: paymentId,\n      reason\n    })\n  });\n}","map":{"version":3,"names":["apiFetch","fetchWorkerBookings","filters","isAdmin","cleanFilters","status","params","URLSearchParams","toString","baseUrl","fetchMyWorkerBookings","createWorkerBooking","payload","method","body","JSON","stringify","assignWorkerToBooking","id","worker_id","updateWorkerBookingStatus","payForWorkerService","requestWorkerRefund","paymentId","reason","payment_id"],"sources":["/home/steve/amala/client/src/api/workerServices.api.js"],"sourcesContent":["import { apiFetch } from \"./client\";\n\n/**\n * GET worker bookings (Standard)\n * - Resident/Worker: uses default RLS endpoint\n * - Admin: uses admin endpoint to bypass RLS\n */\nexport function fetchWorkerBookings(filters = {}, isAdmin = false) {\n  const cleanFilters = {};\n  if (filters.status) {\n    cleanFilters.status = filters.status;\n  }\n\n  const params = new URLSearchParams(cleanFilters).toString();\n\n  const baseUrl = isAdmin\n    ? \"/api/worker-services/admin/all\"\n    : \"/api/worker-services\";\n\n  return apiFetch(`${baseUrl}${params ? `?${params}` : \"\"}`);\n}\n\n/**\n * ✅ NEW: GET /api/worker-services/my-bookings\n * Resident-specific fetch that includes merged payment/refund data\n */\nexport function fetchMyWorkerBookings() {\n  return apiFetch(\"/api/worker-services/my-bookings\");\n}\n\n/**\n * POST /api/worker-services\n * Resident creates booking\n */\nexport function createWorkerBooking(payload) {\n  return apiFetch(\"/api/worker-services\", {\n    method: \"POST\",\n    body: JSON.stringify(payload),\n  });\n}\n\n/**\n * PATCH /api/worker-services/:id/assign\n * Admin assigns worker\n */\nexport function assignWorkerToBooking(id, worker_id) {\n  return apiFetch(`/api/worker-services/${id}/assign`, {\n    method: \"PATCH\",\n    body: JSON.stringify({ worker_id }),\n  });\n}\n\n/**\n * PATCH /api/worker-services/:id/status\n * Worker updates booking status\n */\nexport function updateWorkerBookingStatus(id, status) {\n  return apiFetch(`/api/worker-services/${id}/status`, {\n    method: \"PATCH\",\n    body: JSON.stringify({ status }),\n  });\n}\n\n/**\n * POST /api/worker-services/:id/pay\n * Resident pays for a completed service\n */\nexport function payForWorkerService(id, payload) {\n  return apiFetch(`/api/worker-services/${id}/pay`, {\n    method: \"POST\",\n    body: JSON.stringify(payload),\n  });\n}\n\n/**\n * ✅ NEW: POST /api/refunds/worker/request\n * Resident requests a refund for a worker service payment\n */\nexport function requestWorkerRefund(paymentId, reason = \"Service not needed\") {\n  return apiFetch(\"/api/refunds/worker/request\", {\n    method: \"POST\",\n    body: JSON.stringify({ payment_id: paymentId, reason }),\n  });\n}"],"mappings":"AAAA,SAASA,QAAQ,QAAQ,UAAU;;AAEnC;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,mBAAmBA,CAACC,OAAO,GAAG,CAAC,CAAC,EAAEC,OAAO,GAAG,KAAK,EAAE;EACjE,MAAMC,YAAY,GAAG,CAAC,CAAC;EACvB,IAAIF,OAAO,CAACG,MAAM,EAAE;IAClBD,YAAY,CAACC,MAAM,GAAGH,OAAO,CAACG,MAAM;EACtC;EAEA,MAAMC,MAAM,GAAG,IAAIC,eAAe,CAACH,YAAY,CAAC,CAACI,QAAQ,CAAC,CAAC;EAE3D,MAAMC,OAAO,GAAGN,OAAO,GACnB,gCAAgC,GAChC,sBAAsB;EAE1B,OAAOH,QAAQ,CAAC,GAAGS,OAAO,GAAGH,MAAM,GAAG,IAAIA,MAAM,EAAE,GAAG,EAAE,EAAE,CAAC;AAC5D;;AAEA;AACA;AACA;AACA;AACA,OAAO,SAASI,qBAAqBA,CAAA,EAAG;EACtC,OAAOV,QAAQ,CAAC,kCAAkC,CAAC;AACrD;;AAEA;AACA;AACA;AACA;AACA,OAAO,SAASW,mBAAmBA,CAACC,OAAO,EAAE;EAC3C,OAAOZ,QAAQ,CAAC,sBAAsB,EAAE;IACtCa,MAAM,EAAE,MAAM;IACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACJ,OAAO;EAC9B,CAAC,CAAC;AACJ;;AAEA;AACA;AACA;AACA;AACA,OAAO,SAASK,qBAAqBA,CAACC,EAAE,EAAEC,SAAS,EAAE;EACnD,OAAOnB,QAAQ,CAAC,wBAAwBkB,EAAE,SAAS,EAAE;IACnDL,MAAM,EAAE,OAAO;IACfC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MAAEG;IAAU,CAAC;EACpC,CAAC,CAAC;AACJ;;AAEA;AACA;AACA;AACA;AACA,OAAO,SAASC,yBAAyBA,CAACF,EAAE,EAAEb,MAAM,EAAE;EACpD,OAAOL,QAAQ,CAAC,wBAAwBkB,EAAE,SAAS,EAAE;IACnDL,MAAM,EAAE,OAAO;IACfC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MAAEX;IAAO,CAAC;EACjC,CAAC,CAAC;AACJ;;AAEA;AACA;AACA;AACA;AACA,OAAO,SAASgB,mBAAmBA,CAACH,EAAE,EAAEN,OAAO,EAAE;EAC/C,OAAOZ,QAAQ,CAAC,wBAAwBkB,EAAE,MAAM,EAAE;IAChDL,MAAM,EAAE,MAAM;IACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACJ,OAAO;EAC9B,CAAC,CAAC;AACJ;;AAEA;AACA;AACA;AACA;AACA,OAAO,SAASU,mBAAmBA,CAACC,SAAS,EAAEC,MAAM,GAAG,oBAAoB,EAAE;EAC5E,OAAOxB,QAAQ,CAAC,6BAA6B,EAAE;IAC7Ca,MAAM,EAAE,MAAM;IACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MAAES,UAAU,EAAEF,SAAS;MAAEC;IAAO,CAAC;EACxD,CAAC,CAAC;AACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}