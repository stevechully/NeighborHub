{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import axios from\"axios\";import{supabase}from\"../../lib/supabase\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BACKEND_URL=\"http://localhost:4000/api\";export default function AdminRefunds(){const[refunds,setRefunds]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{fetchRefunds();},[]);const fetchRefunds=async()=>{try{setLoading(true);const{data:{session}}=await supabase.auth.getSession();const res=await axios.get(\"\".concat(BACKEND_URL,\"/refunds?status=PENDING\"),{headers:{Authorization:\"Bearer \".concat(session===null||session===void 0?void 0:session.access_token)}});setRefunds(res.data);}catch(err){console.error(\"Fetch refunds failed\",err);}finally{setLoading(false);}};const handleAction=async(id,action)=>{if(!window.confirm(\"Are you sure you want to \".concat(action,\" this refund?\")))return;try{const{data:{session}}=await supabase.auth.getSession();await axios.patch(\"\".concat(BACKEND_URL,\"/refunds/\").concat(id,\"/\").concat(action),{},{headers:{Authorization:\"Bearer \".concat(session===null||session===void 0?void 0:session.access_token)}});alert(\"Refund \".concat(action,\"ed successfully!\"));fetchRefunds();}catch(err){var _err$response,_err$response$data;alert(\"Action failed: \".concat(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||err.message));}};if(loading)return/*#__PURE__*/_jsx(\"div\",{style:{padding:20},children:\"Loading requests...\"});return/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"24px\"},children:[/*#__PURE__*/_jsx(\"h2\",{style:{marginBottom:\"20px\"},children:\"Refund Management (Pending)\"}),refunds.length===0?/*#__PURE__*/_jsx(\"div\",{style:{padding:40,background:\"#fff\",borderRadius:12,textAlign:'center',color:'#666'},children:\"No pending refund requests found.\"}):/*#__PURE__*/_jsx(\"div\",{style:{display:\"grid\",gap:\"16px\"},children:refunds.map(refund=>{var _refund$profiles,_refund$profiles2;return/*#__PURE__*/_jsxs(\"div\",{style:{border:\"1px solid #e5e7eb\",padding:\"20px\",borderRadius:\"12px\",background:\"#fff\",boxShadow:\"0 2px 4px rgba(0,0,0,0.05)\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'start'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'12px',fontWeight:'bold',color:'#1e40af',textTransform:'uppercase'},children:refund.payment_type}),/*#__PURE__*/_jsxs(\"h3\",{style:{margin:\"4px 0\"},children:[\"\\u20B9\",refund.refund_amount]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'right',fontSize:'14px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'600'},children:(_refund$profiles=refund.profiles)===null||_refund$profiles===void 0?void 0:_refund$profiles.full_name}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#6b7280'},children:(_refund$profiles2=refund.profiles)===null||_refund$profiles2===void 0?void 0:_refund$profiles2.email})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{margin:'16px 0',padding:'12px',background:'#f9fafb',borderRadius:'8px',fontSize:'14px'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Reason:\"}),\" \",refund.reason]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:\"12px\"},children:[/*#__PURE__*/_jsx(\"button\",{style:{backgroundColor:\"#166534\",color:\"white\",border:'none',padding:'10px 20px',borderRadius:'8px',cursor:'pointer',fontWeight:'600'},onClick:()=>handleAction(refund.id,'approve'),children:\"Approve Refund\"}),/*#__PURE__*/_jsx(\"button\",{style:{backgroundColor:\"#991b1b\",color:\"white\",border:'none',padding:'10px 20px',borderRadius:'8px',cursor:'pointer',fontWeight:'600'},onClick:()=>handleAction(refund.id,'reject'),children:\"Reject\"})]})]},refund.id);})})]});}","map":{"version":3,"names":["React","useEffect","useState","axios","supabase","jsx","_jsx","jsxs","_jsxs","BACKEND_URL","AdminRefunds","refunds","setRefunds","loading","setLoading","fetchRefunds","data","session","auth","getSession","res","get","concat","headers","Authorization","access_token","err","console","error","handleAction","id","action","window","confirm","patch","alert","_err$response","_err$response$data","response","message","style","padding","children","marginBottom","length","background","borderRadius","textAlign","color","display","gap","map","refund","_refund$profiles","_refund$profiles2","border","boxShadow","justifyContent","alignItems","fontSize","fontWeight","textTransform","payment_type","margin","refund_amount","profiles","full_name","email","reason","backgroundColor","cursor","onClick"],"sources":["/home/steve/amala/client/src/pages/admin/AdminRefunds.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { supabase } from \"../../lib/supabase\";\n\nconst BACKEND_URL = \"http://localhost:4000/api\";\n\nexport default function AdminRefunds() {\n  const [refunds, setRefunds] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    fetchRefunds();\n  }, []);\n\n  const fetchRefunds = async () => {\n    try {\n      setLoading(true);\n      const { data: { session } } = await supabase.auth.getSession();\n      const res = await axios.get(`${BACKEND_URL}/refunds?status=PENDING`, {\n        headers: { Authorization: `Bearer ${session?.access_token}` }\n      });\n      setRefunds(res.data);\n    } catch (err) {\n      console.error(\"Fetch refunds failed\", err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleAction = async (id, action) => {\n    if (!window.confirm(`Are you sure you want to ${action} this refund?`)) return;\n    try {\n      const { data: { session } } = await supabase.auth.getSession();\n      await axios.patch(`${BACKEND_URL}/refunds/${id}/${action}`, {}, {\n        headers: { Authorization: `Bearer ${session?.access_token}` }\n      });\n      alert(`Refund ${action}ed successfully!`);\n      fetchRefunds();\n    } catch (err) {\n      alert(`Action failed: ${err.response?.data?.error || err.message}`);\n    }\n  };\n\n  if (loading) return <div style={{ padding: 20 }}>Loading requests...</div>;\n\n  return (\n    <div style={{ padding: \"24px\" }}>\n      <h2 style={{ marginBottom: \"20px\" }}>Refund Management (Pending)</h2>\n\n      {refunds.length === 0 ? (\n        <div style={{ padding: 40, background: \"#fff\", borderRadius: 12, textAlign: 'center', color: '#666' }}>\n          No pending refund requests found.\n        </div>\n      ) : (\n        <div style={{ display: \"grid\", gap: \"16px\" }}>\n          {refunds.map((refund) => (\n            <div\n              key={refund.id}\n              style={{\n                border: \"1px solid #e5e7eb\",\n                padding: \"20px\",\n                borderRadius: \"12px\",\n                background: \"#fff\",\n                boxShadow: \"0 2px 4px rgba(0,0,0,0.05)\"\n              }}\n            >\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start' }}>\n                <div>\n                  <span style={{ fontSize: '12px', fontWeight: 'bold', color: '#1e40af', textTransform: 'uppercase' }}>\n                    {refund.payment_type}\n                  </span>\n                  <h3 style={{ margin: \"4px 0\" }}>â‚¹{refund.refund_amount}</h3>\n                </div>\n                <div style={{ textAlign: 'right', fontSize: '14px' }}>\n                  <div style={{ fontWeight: '600' }}>{refund.profiles?.full_name}</div>\n                  <div style={{ color: '#6b7280' }}>{refund.profiles?.email}</div>\n                </div>\n              </div>\n\n              <div style={{ margin: '16px 0', padding: '12px', background: '#f9fafb', borderRadius: '8px', fontSize: '14px' }}>\n                <strong>Reason:</strong> {refund.reason}\n              </div>\n\n              <div style={{ display: \"flex\", gap: \"12px\" }}>\n                <button\n                  style={{\n                    backgroundColor: \"#166534\",\n                    color: \"white\",\n                    border: 'none',\n                    padding: '10px 20px',\n                    borderRadius: '8px',\n                    cursor: 'pointer',\n                    fontWeight: '600'\n                  }}\n                  onClick={() => handleAction(refund.id, 'approve')}\n                >\n                  Approve Refund\n                </button>\n\n                <button\n                  style={{\n                    backgroundColor: \"#991b1b\",\n                    color: \"white\",\n                    border: 'none',\n                    padding: '10px 20px',\n                    borderRadius: '8px',\n                    cursor: 'pointer',\n                    fontWeight: '600'\n                  }}\n                  onClick={() => handleAction(refund.id, 'reject')}\n                >\n                  Reject\n                </button>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}