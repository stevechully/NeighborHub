{"ast":null,"code":"import{useEffect,useState}from\"react\";import{useNavigate}from\"react-router-dom\";import{useAuth}from\"../../auth/AuthContext\";import{fetchFacilities}from\"../../api/facilities.api\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function FacilitiesPage(){var _profile$roles,_profile$user_roles;const navigate=useNavigate();const{profile,loading:authLoading}=useAuth();const roleName=(profile===null||profile===void 0?void 0:(_profile$roles=profile.roles)===null||_profile$roles===void 0?void 0:_profile$roles.name)||(profile===null||profile===void 0?void 0:profile.role)||(profile===null||profile===void 0?void 0:(_profile$user_roles=profile.user_roles)===null||_profile$user_roles===void 0?void 0:_profile$user_roles.role)||null;const isResident=roleName===\"RESIDENT\";const[facilities,setFacilities]=useState([]);const[loading,setLoading]=useState(true);async function loadFacilities(){try{setLoading(true);const data=await fetchFacilities();setFacilities(data||[]);}catch(err){console.log(\"❌ Facilities fetch failed:\",err.message);alert(err.message);}finally{setLoading(false);}}useEffect(()=>{if(!authLoading&&profile){loadFacilities();}// eslint-disable-next-line\n},[authLoading,profile]);if(authLoading||!profile){return/*#__PURE__*/_jsx(\"div\",{style:{padding:40,textAlign:\"center\"},children:/*#__PURE__*/_jsx(\"p\",{children:\"Verifying session...\"})});}return/*#__PURE__*/_jsxs(\"div\",{style:{padding:20},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\"},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Facilities\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(\"/facilities/bookings\"),style:{padding:\"8px 16px\",cursor:\"pointer\"},children:\"My Bookings\"})]}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading facilities...\"}):facilities.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No facilities available.\"}):/*#__PURE__*/_jsx(\"div\",{style:{display:\"grid\",gridTemplateColumns:\"repeat(auto-fit, minmax(280px, 1fr))\",gap:16,marginTop:16},children:facilities.map(f=>{var _f$capacity;return/*#__PURE__*/_jsxs(\"div\",{style:{background:\"#fff\",borderRadius:12,padding:16,boxShadow:\"0 2px 10px rgba(0,0,0,0.06)\",border:\"1px solid #eee\",display:\"flex\",flexDirection:\"column\",justifyContent:\"space-between\"},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginTop:0},children:f.name}),/*#__PURE__*/_jsx(\"p\",{style:{color:\"#555\",minHeight:40},children:f.description||\"No description\"}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:14,color:\"#666\",marginBottom:10},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Capacity:\"}),\" \",(_f$capacity=f.capacity)!==null&&_f$capacity!==void 0?_f$capacity:\"N/A\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Open:\"}),\" \",f.open_time,\" \\u2192 \",f.close_time]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Paid:\"}),\" \",f.is_paid?\"Yes\":\"No\"]}),f.is_paid&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Fee:\"}),\" \\u20B9\",f.fee]})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:12,paddingTop:12,borderTop:\"1px solid #eee\"},children:isResident?/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(\"/facilities/\".concat(f.id)),style:{width:\"100%\",padding:12,borderRadius:8,border:\"none\",cursor:\"pointer\",background:\"#111\",color:\"#fff\",fontWeight:\"600\"},children:\"View Availability & Book\"}):/*#__PURE__*/_jsx(\"p\",{style:{color:\"#777\",fontSize:13,textAlign:\"center\"},children:\"Residents only\"})})]},f.id);})})]});}","map":{"version":3,"names":["useEffect","useState","useNavigate","useAuth","fetchFacilities","jsx","_jsx","jsxs","_jsxs","FacilitiesPage","_profile$roles","_profile$user_roles","navigate","profile","loading","authLoading","roleName","roles","name","role","user_roles","isResident","facilities","setFacilities","setLoading","loadFacilities","data","err","console","log","message","alert","style","padding","textAlign","children","display","justifyContent","alignItems","onClick","cursor","length","gridTemplateColumns","gap","marginTop","map","f","_f$capacity","background","borderRadius","boxShadow","border","flexDirection","color","minHeight","description","fontSize","marginBottom","capacity","open_time","close_time","is_paid","fee","paddingTop","borderTop","concat","id","width","fontWeight"],"sources":["/home/steve/amala/client/src/pages/facilities/FacilitiesPage.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useAuth } from \"../../auth/AuthContext\";\nimport { fetchFacilities } from \"../../api/facilities.api\";\n\nexport default function FacilitiesPage() {\n  const navigate = useNavigate();\n  const { profile, loading: authLoading } = useAuth();\n\n  const roleName =\n    profile?.roles?.name || profile?.role || profile?.user_roles?.role || null;\n\n  const isResident = roleName === \"RESIDENT\";\n\n  const [facilities, setFacilities] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  async function loadFacilities() {\n    try {\n      setLoading(true);\n      const data = await fetchFacilities();\n      setFacilities(data || []);\n    } catch (err) {\n      console.log(\"❌ Facilities fetch failed:\", err.message);\n      alert(err.message);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  useEffect(() => {\n    if (!authLoading && profile) {\n      loadFacilities();\n    }\n    // eslint-disable-next-line\n  }, [authLoading, profile]);\n\n  if (authLoading || !profile) {\n    return (\n      <div style={{ padding: 40, textAlign: \"center\" }}>\n        <p>Verifying session...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div style={{ padding: 20 }}>\n      <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\n        <h2>Facilities</h2>\n\n        <button \n          onClick={() => navigate(\"/facilities/bookings\")}\n          style={{ padding: \"8px 16px\", cursor: \"pointer\" }}\n        >\n          My Bookings\n        </button>\n      </div>\n\n      {loading ? (\n        <p>Loading facilities...</p>\n      ) : facilities.length === 0 ? (\n        <p>No facilities available.</p>\n      ) : (\n        <div\n          style={{\n            display: \"grid\",\n            gridTemplateColumns: \"repeat(auto-fit, minmax(280px, 1fr))\",\n            gap: 16,\n            marginTop: 16,\n          }}\n        >\n          {facilities.map((f) => (\n            <div\n              key={f.id}\n              style={{\n                background: \"#fff\",\n                borderRadius: 12,\n                padding: 16,\n                boxShadow: \"0 2px 10px rgba(0,0,0,0.06)\",\n                border: \"1px solid #eee\",\n                display: \"flex\",\n                flexDirection: \"column\",\n                justifyContent: \"space-between\"\n              }}\n            >\n              <div>\n                <h3 style={{ marginTop: 0 }}>{f.name}</h3>\n\n                <p style={{ color: \"#555\", minHeight: 40 }}>\n                  {f.description || \"No description\"}\n                </p>\n\n                <div style={{ fontSize: 14, color: \"#666\", marginBottom: 10 }}>\n                  <div><strong>Capacity:</strong> {f.capacity ?? \"N/A\"}</div>\n                  <div><strong>Open:</strong> {f.open_time} → {f.close_time}</div>\n                  <div><strong>Paid:</strong> {f.is_paid ? \"Yes\" : \"No\"}</div>\n                  {f.is_paid && <div><strong>Fee:</strong> ₹{f.fee}</div>}\n                </div>\n              </div>\n\n              <div style={{ marginTop: 12, paddingTop: 12, borderTop: \"1px solid #eee\" }}>\n                {isResident ? (\n                  <button\n                    onClick={() => navigate(`/facilities/${f.id}`)}\n                    style={{\n                      width: \"100%\",\n                      padding: 12,\n                      borderRadius: 8,\n                      border: \"none\",\n                      cursor: \"pointer\",\n                      background: \"#111\",\n                      color: \"#fff\",\n                      fontWeight: \"600\",\n                    }}\n                  >\n                    View Availability & Book\n                  </button>\n                ) : (\n                  <p style={{ color: \"#777\", fontSize: 13, textAlign: \"center\" }}>\n                    Residents only\n                  </p>\n                )}\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}