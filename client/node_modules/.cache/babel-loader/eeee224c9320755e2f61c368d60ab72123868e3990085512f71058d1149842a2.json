{"ast":null,"code":"import{Navigate,useLocation}from\"react-router-dom\";import{useAuth}from\"./AuthContext\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function RequireAuth(_ref){let{children}=_ref;const{user,profile,loading}=useAuth();const location=useLocation();// 1. Wait for AuthContext to finish checking the session\nif(loading){return/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',height:'100vh',fontFamily:'sans-serif'},children:/*#__PURE__*/_jsx(\"p\",{children:\"Loading application...\"})});}// 2. If no user is logged in, redirect to Login\nif(!user){return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",state:{from:location},replace:true});}// 3. UPDATED: If User exists but Profile is still loading/missing\n// We show a clean sync message instead of the red debug error.\nif(!profile){return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',height:'100vh',flexDirection:'column',fontFamily:'sans-serif',color:'#666'},children:[/*#__PURE__*/_jsx(\"p\",{children:\"Synchronizing your profile...\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.location.reload(),style:{marginTop:'10px',padding:'8px 16px',cursor:'pointer',borderRadius:'4px',border:'1px solid #ccc',background:'#fff'},children:\"Refresh Page\"})]});}// 4. Profile is loaded, safe to render the protected content\nreturn children;}","map":{"version":3,"names":["Navigate","useLocation","useAuth","jsx","_jsx","jsxs","_jsxs","RequireAuth","_ref","children","user","profile","loading","location","style","display","justifyContent","alignItems","height","fontFamily","to","state","from","replace","flexDirection","color","onClick","window","reload","marginTop","padding","cursor","borderRadius","border","background"],"sources":["/home/steve/amala/client/src/auth/RequireAuth.js"],"sourcesContent":["import { Navigate, useLocation } from \"react-router-dom\";\nimport { useAuth } from \"./AuthContext\";\n\nexport default function RequireAuth({ children }) {\n  const { user, profile, loading } = useAuth();\n  const location = useLocation();\n\n  // 1. Wait for AuthContext to finish checking the session\n  if (loading) {\n    return (\n      <div style={{ \n        display: 'flex', \n        justifyContent: 'center', \n        alignItems: 'center', \n        height: '100vh',\n        fontFamily: 'sans-serif' \n      }}>\n        <p>Loading application...</p>\n      </div>\n    );\n  }\n\n  // 2. If no user is logged in, redirect to Login\n  if (!user) {\n    return <Navigate to=\"/login\" state={{ from: location }} replace />;\n  }\n\n  // 3. UPDATED: If User exists but Profile is still loading/missing\n  // We show a clean sync message instead of the red debug error.\n  if (!profile) {\n    return (\n      <div style={{ \n        display: 'flex', \n        justifyContent: 'center', \n        alignItems: 'center', \n        height: '100vh',\n        flexDirection: 'column',\n        fontFamily: 'sans-serif',\n        color: '#666'\n      }}>\n        <p>Synchronizing your profile...</p>\n        <button \n          onClick={() => window.location.reload()}\n          style={{ \n            marginTop: '10px', \n            padding: '8px 16px', \n            cursor: 'pointer',\n            borderRadius: '4px',\n            border: '1px solid #ccc',\n            background: '#fff'\n          }}\n        >\n          Refresh Page\n        </button>\n      </div>\n    );\n  }\n\n  // 4. Profile is loaded, safe to render the protected content\n  return children;\n}"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,WAAW,KAAQ,kBAAkB,CACxD,OAASC,OAAO,KAAQ,eAAe,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAExC,cAAe,SAAS,CAAAC,WAAWA,CAAAC,IAAA,CAAe,IAAd,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAC9C,KAAM,CAAEE,IAAI,CAAEC,OAAO,CAAEC,OAAQ,CAAC,CAAGV,OAAO,CAAC,CAAC,CAC5C,KAAM,CAAAW,QAAQ,CAAGZ,WAAW,CAAC,CAAC,CAE9B;AACA,GAAIW,OAAO,CAAE,CACX,mBACER,IAAA,QAAKU,KAAK,CAAE,CACVC,OAAO,CAAE,MAAM,CACfC,cAAc,CAAE,QAAQ,CACxBC,UAAU,CAAE,QAAQ,CACpBC,MAAM,CAAE,OAAO,CACfC,UAAU,CAAE,YACd,CAAE,CAAAV,QAAA,cACAL,IAAA,MAAAK,QAAA,CAAG,wBAAsB,CAAG,CAAC,CAC1B,CAAC,CAEV,CAEA;AACA,GAAI,CAACC,IAAI,CAAE,CACT,mBAAON,IAAA,CAACJ,QAAQ,EAACoB,EAAE,CAAC,QAAQ,CAACC,KAAK,CAAE,CAAEC,IAAI,CAAET,QAAS,CAAE,CAACU,OAAO,MAAE,CAAC,CACpE,CAEA;AACA;AACA,GAAI,CAACZ,OAAO,CAAE,CACZ,mBACEL,KAAA,QAAKQ,KAAK,CAAE,CACVC,OAAO,CAAE,MAAM,CACfC,cAAc,CAAE,QAAQ,CACxBC,UAAU,CAAE,QAAQ,CACpBC,MAAM,CAAE,OAAO,CACfM,aAAa,CAAE,QAAQ,CACvBL,UAAU,CAAE,YAAY,CACxBM,KAAK,CAAE,MACT,CAAE,CAAAhB,QAAA,eACAL,IAAA,MAAAK,QAAA,CAAG,+BAA6B,CAAG,CAAC,cACpCL,IAAA,WACEsB,OAAO,CAAEA,CAAA,GAAMC,MAAM,CAACd,QAAQ,CAACe,MAAM,CAAC,CAAE,CACxCd,KAAK,CAAE,CACLe,SAAS,CAAE,MAAM,CACjBC,OAAO,CAAE,UAAU,CACnBC,MAAM,CAAE,SAAS,CACjBC,YAAY,CAAE,KAAK,CACnBC,MAAM,CAAE,gBAAgB,CACxBC,UAAU,CAAE,MACd,CAAE,CAAAzB,QAAA,CACH,cAED,CAAQ,CAAC,EACN,CAAC,CAEV,CAEA;AACA,MAAO,CAAAA,QAAQ,CACjB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}